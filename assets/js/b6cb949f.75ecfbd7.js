"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[5446],{5680:(e,n,s)=>{s.d(n,{xA:()=>c,yg:()=>g});var a=s(6540);function t(e,n,s){return n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function o(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),s.push.apply(s,a)}return s}function i(e){for(var n=1;n<arguments.length;n++){var s=null!=arguments[n]?arguments[n]:{};n%2?o(Object(s),!0).forEach((function(n){t(e,n,s[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):o(Object(s)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(s,n))}))}return e}function r(e,n){if(null==e)return{};var s,a,t=function(e,n){if(null==e)return{};var s,a,t={},o=Object.keys(e);for(a=0;a<o.length;a++)s=o[a],n.indexOf(s)>=0||(t[s]=e[s]);return t}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)s=o[a],n.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(t[s]=e[s])}return t}var l=a.createContext({}),d=function(e){var n=a.useContext(l),s=n;return e&&(s="function"==typeof e?e(n):i(i({},n),e)),s},c=function(e){var n=d(e.components);return a.createElement(l.Provider,{value:n},e.children)},p="mdxType",m={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},u=a.forwardRef((function(e,n){var s=e.components,t=e.mdxType,o=e.originalType,l=e.parentName,c=r(e,["components","mdxType","originalType","parentName"]),p=d(s),u=t,g=p["".concat(l,".").concat(u)]||p[u]||m[u]||o;return s?a.createElement(g,i(i({ref:n},c),{},{components:s})):a.createElement(g,i({ref:n},c))}));function g(e,n){var s=arguments,t=n&&n.mdxType;if("string"==typeof e||t){var o=s.length,i=new Array(o);i[0]=u;var r={};for(var l in n)hasOwnProperty.call(n,l)&&(r[l]=n[l]);r.originalType=e,r[p]="string"==typeof e?e:t,i[1]=r;for(var d=2;d<o;d++)i[d]=s[d];return a.createElement.apply(null,i)}return a.createElement.apply(null,s)}u.displayName="MDXCreateElement"},3033:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>m,frontMatter:()=>o,metadata:()=>r,toc:()=>d});var a=s(8168),t=(s(6540),s(5680));const o={sidebar_position:4},i="Events",r={unversionedId:"sesami-experience/events",id:"sesami-experience/events",title:"Events",description:"Sesami fires events to help you handle different scenarios in your booking flow. You can listen for these events to trigger different actions, for example when a customer selects a time slot or when Sesami is loaded and initialized on your page.",source:"@site/docs/2-sesami-experience/4-events.md",sourceDirName:"2-sesami-experience",slug:"/sesami-experience/events",permalink:"/docs/sesami-experience/events",draft:!1,editUrl:"https://github.com/sesamiapp/devportal/edit/master/docs/2-sesami-experience/4-events.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"Configurator",permalink:"/docs/sesami-experience/configurator"},next:{title:"Verify Cart",permalink:"/docs/sesami-experience/verify-cart"}},l={},d=[{value:"sesami:loaded",id:"sesamiloaded",level:3},{value:"sesami:modal:opened",id:"sesamimodalopened",level:3},{value:"sesami:modal:closed",id:"sesamimodalclosed",level:3},{value:"sesami:reservation:success",id:"sesamireservationsuccess",level:3},{value:"sesami:reservation:failed",id:"sesamireservationfailed",level:3},{value:"sesami:booking:success",id:"sesamibookingsuccess",level:3},{value:"sesami:booking:failed",id:"sesamibookingfailed",level:3},{value:"change",id:"change",level:3}],c={toc:d},p="wrapper";function m(e){let{components:n,...s}=e;return(0,t.yg)(p,(0,a.A)({},c,s,{components:n,mdxType:"MDXLayout"}),(0,t.yg)("h1",{id:"events"},"Events"),(0,t.yg)("p",null,"Sesami fires events to help you handle different scenarios in your booking flow. You can listen for these events to trigger different actions, for example when a customer selects a time slot or when Sesami is loaded and initialized on your page."),(0,t.yg)("h3",{id:"sesamiloaded"},"sesami:loaded"),(0,t.yg)("p",null,"Sesami resources are loaded in async mode, so they do not block your other resources. Depending on network conditions and the size of other resources, it can take some time until Sesami is fully loaded on a page. This event will let you know when Sesami is ready to accept bookings."),(0,t.yg)("p",null,"This is an example that shows how you can listen for this event and trigger an action based on it:"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-js"},"window.addEventListener('sesami:loaded', () => {\n  console.log('sesami loaded')\n})\n")),(0,t.yg)("h3",{id:"sesamimodalopened"},"sesami:modal:opened"),(0,t.yg)("p",null,"The user has clicked on the button and the modal is opened."),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-js"},"window.addEventListener('sesami:modal:opened', () => {\n  console.log('modal is opened')\n})\n")),(0,t.yg)("h3",{id:"sesamimodalclosed"},"sesami:modal:closed"),(0,t.yg)("p",null,"The modal is closed. Either by clicking on the close button with the user, or due to finishing the reservation/booking process."),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-js"},"window.addEventListener('sesami:modal:closed', () => {\n  console.log('modal is closed')\n})\n")),(0,t.yg)("h3",{id:"sesamireservationsuccess"},"sesami:reservation:success"),(0,t.yg)("p",null,"The reservation process has been completed successfully."),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-js"},"window.addEventListener('sesami:reservation:success', () => {\n  console.log('reservation success')\n})\n")),(0,t.yg)("h3",{id:"sesamireservationfailed"},"sesami:reservation:failed"),(0,t.yg)("p",null,"The reservation process has failed. You can find the error message in the event's detail."),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-ts"},"type ReservationError =\n  'session_expired'  | // the session token has been expired\n  'rate_limit'       | // user sends too many requests\n  'unavailable_slot' | // someone else took the slot\n  'unknown'            // none above\n")),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-js"},"window.addEventListener('sesami:reservation:failed', e => {\n  console.log('reservation failed', e.detail.error)\n})\n")),(0,t.yg)("h3",{id:"sesamibookingsuccess"},"sesami:booking:success"),(0,t.yg)("p",null,"When Instant Booking is enabled, the entire booking flow happens within Sesami. This event is triggered when a slot is successfully booked via Instant Booking.",(0,t.yg)("br",null),"\nYou can get the ",(0,t.yg)("inlineCode",{parentName:"p"},"appointmentId")," in the event's detail."),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-js"},"window.addEventListener('sesami:booking:success', e => {\n  console.log('booking success', e.detail.appointmentId)\n})\n")),(0,t.yg)("h3",{id:"sesamibookingfailed"},"sesami:booking:failed"),(0,t.yg)("p",null,"The booking process has been failed. You can find the error message in the event's detail."),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-ts"},"type BookingError =\n  'session_expired'  | // the session token has been expired\n  'rate_limit'       | // user sends too many requests\n  'unavailable_slot' | // someone else took the slot\n  'invalid_phone'    | // the phone number is not valid\n  'unknown'            // none above\n")),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-js"},"window.addEventListener('sesami:booking:failed', e => {\n  console.log('booking failed', e.detail.error)\n})\n")),(0,t.yg)("h3",{id:"change"},"change"),(0,t.yg)("p",null,"A regular ",(0,t.yg)("inlineCode",{parentName:"p"},"change")," event will be fired on the ",(0,t.yg)("a",{parentName:"p",href:"/docs/sesami-experience/quick-start/#sesami-hidden-fields"},"hidden fields"),"."),(0,t.yg)("p",null,(0,t.yg)("strong",{parentName:"p"},"Example:")," Listen for ",(0,t.yg)("a",{parentName:"p",href:"#sesamimodalopened"},"sesami:modal:opened")," event and once inputs are rendered, listen for the change event on the ",(0,t.yg)("inlineCode",{parentName:"p"},"Date")," input and programmatically create an order without customers having to click on the add to cart button:"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-html"},"<script>\n  (() => {\n    window.addEventListener('sesami:modal:opened', e => {\n      const tagId = e.detail.tagId\n      const hiddenFieldsWrapper = document.getElementById(`sesami-hidden-fields-${tagId}`)\n      const sesamiDateInput = hiddenFieldsWrapper.querySelector(\"[name='properties[Date]']\")\n      sesamiDateInput.addEventListener('change', e => {\n        console.log('date changed', e.target.value)\n        // create order...\n      })\n    })\n  })()\n<\/script>\n")))}m.isMDXComponent=!0}}]);