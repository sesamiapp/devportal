"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[6276],{5680:(e,n,t)=>{t.d(n,{xA:()=>p,yg:()=>m});var r=t(6540);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var l=r.createContext({}),c=function(e){var n=r.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},p=function(e){var n=c(e.components);return r.createElement(l.Provider,{value:n},e.children)},y="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},u=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),y=c(t),u=a,m=y["".concat(l,".").concat(u)]||y[u]||d[u]||o;return t?r.createElement(m,i(i({ref:n},p),{},{components:t})):r.createElement(m,i({ref:n},p))}));function m(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=t.length,i=new Array(o);i[0]=u;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s[y]="string"==typeof e?e:a,i[1]=s;for(var c=2;c<o;c++)i[c]=t[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}u.displayName="MDXCreateElement"},4887:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>c});var r=t(8168),a=(t(6540),t(5680));const o={sidebar_position:4},i="Verify Cart",s={unversionedId:"sesami-experience/verify-cart",id:"sesami-experience/verify-cart",title:"Verify Cart",description:"Appointments in the cart might become unavailable while a customer is still browsing, you can use the verify endpoint to constantly check if the selected slot is still available and prevent double booking.",source:"@site/docs/2-sesami-experience/5-verify-cart.md",sourceDirName:"2-sesami-experience",slug:"/sesami-experience/verify-cart",permalink:"/docs/sesami-experience/verify-cart",draft:!1,editUrl:"https://github.com/sesamiapp/devportal/edit/master/docs/2-sesami-experience/5-verify-cart.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"Events",permalink:"/docs/sesami-experience/events"},next:{title:"Intro",permalink:"/docs/sesami-experience/shopify-integration/intro"}},l={},c=[{value:"Headers",id:"headers",level:3},{value:"Body",id:"body",level:3},{value:"Response",id:"response",level:3},{value:"Example",id:"example",level:3}],p={toc:c},y="wrapper";function d(e){let{components:n,...t}=e;return(0,a.yg)(y,(0,r.A)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,a.yg)("h1",{id:"verify-cart"},"Verify Cart"),(0,a.yg)("p",null,"Appointments in the cart might become unavailable while a customer is still browsing, you can use the verify endpoint to constantly check if the selected slot is still available and prevent double booking."),(0,a.yg)("p",null,"You need to send the cart data via ",(0,a.yg)("inlineCode",{parentName:"p"},"POST")," to the endpoint ",(0,a.yg)("inlineCode",{parentName:"p"},"https://app.sesami.co/availabilities/verify-cart"),"."),(0,a.yg)("h3",{id:"headers"},"Headers"),(0,a.yg)("p",null,"Include the following headers:"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"'Content-Type': 'application/json'"),(0,a.yg)("li",{parentName:"ul"},"'Accept': 'application/json',"),(0,a.yg)("li",{parentName:"ul"},"'x-sesami-origin': https://",(0,a.yg)("inlineCode",{parentName:"li"},"STORE"),".myshopify.com")),(0,a.yg)("h3",{id:"body"},"Body"),(0,a.yg)("p",null,"Include as the POST body the response from calling ",(0,a.yg)("a",{parentName:"p",href:"https://shopify.dev/api/ajax/reference/cart#get-cart-js"},(0,a.yg)("strong",{parentName:"a"},"GET /cart.js"))),(0,a.yg)("h3",{id:"response"},"Response"),(0,a.yg)("p",null,"You will get an object with two arrays: ",(0,a.yg)("inlineCode",{parentName:"p"},"allowed"),", ",(0,a.yg)("inlineCode",{parentName:"p"},"rejected"),"."),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"allowed: contains all the elements that  are currently available."),(0,a.yg)("li",{parentName:"ul"},"rejected: contains all the elements that  are not currently available.")),(0,a.yg)("h3",{id:"example"},"Example"),(0,a.yg)("p",null,"This code demonstrates how to use Sesami verify-cart. "),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-ts"},"async fetchCart = () => {\n\n  try{\n  \n    // get cart data:\n    const response = await fetch('/cart.js')\n    if(!response.ok){\n      throw new Error(response.status)\n    }\n    const cart = await response.json()\n\n    // verify cart data:\n    if(cart.item_count){\n      \n      const config = {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Accept': `application/json`, \n          'x-sesami-origin': (window.Shopify && window.Shopify.shop && `https://${window.Shopify.shop}`) || (window.location && window.location.origin)\n        },\n        body: JSON.stringify(cart)\n      }\n\n      const response = await fetch('https://app.sesami.co/availabilities/verify-cart', config)\n      \n      if(response.status === 200){\n        const responseJson = await response.json()\n        console.log(responseJson)\n      }else{\n        console.error('error:', response.status)\n      }\n\n    }\n\n  }\n  catch(error){\n    console.error('error:', error)\n  }\n\n}\n\nfetchCart()\n")))}d.isMDXComponent=!0}}]);